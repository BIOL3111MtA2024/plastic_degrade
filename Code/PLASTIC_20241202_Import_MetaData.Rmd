---
title: "Import_MetaData"
author:
- Mireille Savoie
- Douglas A. Campbell
- Heather MacTavish
date: "`r format(Sys.Date())`"
output:
bookdown::html_document2:
    code_folding: show
    keep_md: yes
    toc: TRUE
    toc_float: TRUE
    toc_depth: 6
    fig_caption: yes
bibliography: Manuscript_O2.bib
csl: plos-one.csl
editor_options: 
  markdown: 
    wrap: 72
---

# Acknowledgement
This R markdown file was created by Mireille Savoie and Douglas A. Campbell, and was adapted to meet the requirements of the Plastic Degredation term project for BIOL3111 in 2024.


# Set Options

## Set figure caption font size

```{css, echo=FALSE}
p.caption {
  font-size: 18px;
}
```

## Set Chunk Options

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
knitr::opts_chunk$set(fig.path='Figs/')
```


# Introduction

This RMD imports meta data for MultiCultivator experiments from an excel sheet.


# Load Libraries and set Project Variables

```{r load libraries}

library(tidyverse)
library(lubridate)
library(knitr)
library(data.table)
```

```{r set project variables}
#"..", takes up a level in the directory path
Project <- "Plastic"
DataOut <- file.path("..","Data", "RawData")
# ProjectRows <- c("MiSa|JuNa|SaAr|MaBe|LaGe")
# ProjectCols <- c("PrimaryOperator", "SampleID", "Run", "Strain", "ExpCul", "ExpDate", "ExpStartTime", "Par_ue", "Photoperiod", "Temp_c", "MC", "Tube","O2", "O2_Category", "WL","LightShape", "Optode","OptodeCh","OptodeMeasure", "ExpEndDate")

```

# Import MetaData 


```{r load Catalog direct from googlesheet, results = "hide"}
# load CSV for plastic project
CultureCatalog <- read.csv("../Data/RawData/PLASTIC_20241202_MetaData_CSV.csv")

  # When using read_sheets()  WL is set to a list since some values are numbers, some are strings, some are blank.
  # To fix this, first drop all rows missing WL, then unlist.
  # Must first drop NA rows since unlist will collapse NULL lists, then the unlisted WL is a shorter length than original WL column, which mutate doesn't like.

CultureCatalog <- CultureCatalog %>% 
 drop_na(WL) %>%
  mutate(WL = unlist(WL)) %>%
   mutate(ExpStartDate = ymd(ExpStartDate),
           ExpEndDate = ymd_hms(`ExpEndDate`))
head(CultureCatalog)

saveRDS(object = CultureCatalog, file = file.path(DataOut, "CultureCatalog.Rds"), compress = "xz")

```
